{% extends "base.html" %}
{% load static %}
{% block title %}{{ player.Name }}{% endblock %}
{% block content %}
<div class="main-nav">
    <div class="grid-container">
        <div class="data-column">

            <div class="main-nav-header">
                <h1>{{ player.Name }}</h1>
            </div>

            <div class="main-nav-body">
                
                <!--Shirt image with number-->
                <div class="shirt-container">
                    <!-- Use player's name and number to customize the shirt -->
                    <img src="{% static 'smartscore/images/shirt.png' %}" alt="Shirt" class="shirt-image">
                    <div class="player-details">
                        <p class="player-name" id="player-name">{{ player.Name }}</p>
                        <p class="player-number" id="player-number">{{ player.Dorsal }}</p>
                    </div>
                </div>
                <br>
                <h3>Club: {{ player.Club }}</h3>
                <h3>Country: {{ player.Nationality }} </h3>
                <img src="{% static 'smartscore/images/flags/normal/'|add:flag_number|add:'.png' %}" alt="{{ player.Nationality }}" class="flag-icon">
                <h3>Transfermarkt Estimated Value: â‚¬{{player.market_value}}M</h3>
                <h3>League: {{ player.League }}</h3>
                <h3>League Country: {{ player.Country_league }}</h3>
                <h3>Contract Due: {{ player.End_contract }}</h3>
                <h3>Wage: {{ player.Salary }} $</h3>
                <br>
                <h3>Positions:</h3>
                    <ul>
                        {% for position in player.Pos.all %}
                            <li>{{ position }}</li>
                        {% endfor %}
                    </ul>    
                <h3>Leg: {{ player.Pref_foot}} </h3>
                <h3>Age: {{ player.Age }}</h3>
                
            
                <h3>Height: {{ player.Height }} cm</h3>
                <h3>Weight: {{ player.Weight }} kg</h3><br>

            </div>
        </div>

        <div class="image-column">
            <!-- Field image container -->
            <div class="Football-field-container">
                <img src="{% static 'smartscore/images/field.jpg' %}" alt="Football Field">
                <!-- Player position dots -->
                {% for dot_position in dot_positions %}
                    <div class="player-position-dot" style="left: {{ dot_position.left }}px; top: {{ dot_position.top }}px;"></div>
                {% endfor %}
            </div>
        </div>

        <div class="chart-column">
                <div class="bubble-container-smartscore">
                    <div id="smartScoreDisplay" class="bubble-smartscore">--</div>
                </div>
            
                <canvas id="radarChart" width="400" height="400"></canvas>
                <h3>{{player.Name}} stats: </h3>
                <ul>
                    {% for key, value in stats.items %}
                        <li>{{ key }}: {{ value }}</li>
                    {% endfor %}
                </ul>

                <ul id="avg_stats">
                    <p>Select a position to compare player stats vs average position stats.</p>
                </ul>
        </div>

        
    </div>
    
     <!-- Add to Squad Form -->
     {% if request.user.is_authenticated %}
        <form action="{% url 'add_to_squad' player.custom_id %}" method="post">
            {% csrf_token %}
            <select name="squad" class="squad-select">
                {% for squad in squads %}
                    <option value="{{ squad.id }}">{{ squad.name }}</option>
                {% endfor %}
                {% if not squads %}
                    <option value="0">No squads available</option>
                {% endif %}
            </select>
            <button class ="primary-default-btn" type="submit">Add to Squad</button>
        </form>
     {% else %}
        
        <p>Please <a href="{% url 'login' %}?next={{ request.path }}">login</a> to add this player to a squad.</p>
     {% endif %}

    <script>
        var custom_id = {{ player.custom_id }};
        var player_name = "{{ player.Name }}";
    </script>


    <script src="{% static 'js_content/player_detail.js' %}"></script>


</div>
{% endblock %}
